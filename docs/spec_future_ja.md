# FairSoil Phase2+ ノート（日本語）

このドキュメントは、**現時点のオンチェーン実装に含まれない将来案**をまとめたものです。  
README_ja.md の実装済み仕様と混在しないよう、Phase2+の構想はここへ集約します。

## Phase2+ 構想（概要）
- APPI の confidence 強化（価格操作耐性）。
- 追加のガバナンス/インセンティブ・モジュール（QF/RPGF、予測など）。
- UX/AI 支援の拡張（オフチェーンのみ）。

## Phase2+ 構想（詳細）
### 1) APPI Confidence 強化
- APPI の寄与に confidence を付与（例: 最小報告人数、多様性、鮮度）。
- 相関の高い報告を減衰し、価格操作を抑える。
  - **最小実装:** confidenceBps（0〜100%）と maxReportsPerCategory を追加し、中央値に重み付けを適用。

### 2) 公共財ファンディング・モジュール
- Quadratic Funding（QF）で幅広い参加を促進。
- Retroactive Public Goods Funding（RPGF）で成果確認後に報酬。

### 3) 予測と早期警告
- サプライチェーン等のリスクに対する予測市場/ステーキング。
- 「当てた利益」ではなく、**後に正しいと証明された早期警告**を報酬化。

### 4) 保険・再保険プール
- コミュニティ単位の保険プールで事故リスクを吸収。
- 大災害向けに再保険レイヤーを用意。

### 5) コンプライアンス・モジュール（任意）
- 地域要件に合わせた差し替え可能なアダプタ。
- コミュニティ単位で opt-in（全体強制にはしない）。

### 6) 資源税（Harberger）の最小実装
- **目的:** 資源の独占コスト化を最小構成で実装し、循環を促す。
- **最小仕様:** ResourceRegistry が資源IDを登録し、自己評価額と税率に基づいて Token B を定期支払い（pull型）で Treasury に移転する。
- **買い取り口:** `buyResource` を用意し、評価額以上でオンチェーンの所有権のみ移転（物理執行は後回し）。

### 7) CovenantLibrary（テンプレ共有 + ロイヤリティ）
- **目的:** 良い掟（手順/テンプレ）の共有と再利用を促進し、先駆者へ還流する。
- **最小仕様:** テンプレの登録（metadataUri/royaltyBps）と有効化/無効化、ロイヤリティ計算のみを提供する。
- **注意:** 自動分配は後続フェーズで接続（まずはイベント記録）。
  - **運用メモ:** テンプレ使用は `recordUse` で記録し、後続の分配ロジックに接続する。
  - **接続設計（ロイヤリティ自動分配の最小案）:**
    1) Covenantの決済時（`approve`/`resolveDispute`）に、支払い額と `templateId` を参照可能にする。
    2) `RoyaltyRouter` のような専用コントラクトを後続で追加し、Covenantから `notifyPayout(covenantId, templateId, amountB)` を呼び出す。
    3) Routerは `CovenantLibrary` の `royaltyBps` からロイヤリティ額を計算し、テンプレ作成者へ `TokenB` を送る。
    4) 二重支払い防止のため `royaltyPaid[covenantId]` を保持する。
    5) フォールバック運用として、当面はイベント集計→運用者が `settleRoyalty` を実行する方式でも良い。

### 8) 教育支援テンプレ（Covenant流用）
- **目的:** 後払い型の育成支援を「掟テンプレ」として提供する。
- **最小仕様:** 教育支援用テンプレ（metadataUri）を用意し、Covenant作成時にテンプレIDを指定して `recordUse` を記録する。
- **運用:** 成果判定や返済条件の適用はオフチェーン運用から開始し、後続でオンチェーン化する。
  - **運用フロー（最小）:**
    1) 教育支援テンプレを登録（metadataUriに「対象/期間/達成基準/返済条件」を記載）
    2) 受講者が Covenant を作成しテンプレIDを指定（`recordUse` で記録）
    3) 進捗・成果はオフチェーンで検証（提出物/試験/第三者評価）
    4) 成果達成時に報酬/返済を Covenant の支払として確定
    5) 返済条件は最初は運用で管理し、後続フェーズで自動化
